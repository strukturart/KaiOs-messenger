window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);var e=function(e,t,a){document.querySelector("div#bottom-bar div#button-left").textContent=e,document.querySelector("div#bottom-bar div#button-center").textContent=t,document.querySelector("div#bottom-bar div#button-right").textContent=a,document.querySelector("div#bottom-bar").style.display=""==e&&""==t&&""==a?"none":"block"};var t=[{chat_group:"KaiOs",DocumentList:[{user:"ivan",message:"hello",time:1607110465663,read:!1},{user:"per",message:"hello world",time:1607110465663,read:!0}]},{chat_group:"bHackers",DocumentList:[{user:"perry",message:"hey",time:1607110465663,read:!1},{user:"northman",message:"hey you",time:1651756417,read:!1}]},{chat_group:"chaos",DocumentList:[{user:"perry",message:"hey",time:1607110465663,read:!1},{user:"northman",message:"hey you",time:1607110465663,read:!1}]}],a=["January","February","March","April","May","June","July","August","September","October","November","December"];function n(e,t,a,n){if(n){var c=e.filter((function(e){return e.chat_group==n}));e=c}try{var o=Handlebars.compile(t);document.getElementById(a).innerHTML=o({data:e})}catch(e){console.log(e.message)}}Handlebars.registerHelper("transform_date",(function(e){var t=new Date(e);return t.getDate()+" "+a[t.getMonth()]+" "+t.getFullYear()+", "+t.getHours()+":"+t.getMinutes()}));var c=document.getElementById("page-login"),o=document.getElementById("page-chats"),i=document.getElementById("page-chat"),r=document.getElementById("options"),s={view:"page-login"},d=document.querySelectorAll(".page"),u=function(){d.forEach((function(e){e.style.display="none"})),"page-login"==s.view&&(c.style.display="block",document.querySelector("div#page-login div").focus(),e("","","")),"page-chats"==s.view&&(document.getElementById("message-input").style.display="none",o.style.display="block",n(t,'{{#each data}}<article data-function="open-chat" tabindex="{{@index}}" data-id="{{chat_group}}"> <h2>{{chat_group}}</h2></article> {{/each}}',"page-chats"),o.firstElementChild.focus(),e("","select","")),"page-chat"==s.view&&(n(t,'{{#each data}}{{#DocumentList}}<article tabindex="{{@index}}"><div class="user-date"><span>{{user}}</span> {{time}}</div><div>{{message}}</div></article>{{/DocumentList}}{{/each}}',"page-chat",document.activeElement.getAttribute("data-id")),i.style.display="block",i.firstElementChild.focus(),e("write","select","option")),"page-options"==s.view&&(r.style.display="block",document.querySelector("div#page-login div").focus(),e("","select",""))};u();document.addEventListener("DOMContentLoaded",(function(t){var a,n=function(t){switch(t.key){case"*":case"ArrowRight":case"ArrowLeft":case"1":case"3":case"2":case"#":case"7":case"SoftRight":case"Alt":break;case"ArrowUp":c(-1),s.view;break;case"ArrowDown":c(1),s.view;break;case"SoftLeft":case"Control":"page-chat"==s.view&&(document.getElementById("message-input").style.display="flex",document.querySelector("div#message-input input").focus(),e("cancel","send","attachment"));break;case"Enter":if(document.activeElement.classList.contains("input-parent")&&document.activeElement.children[1].focus(),"BUTTON"==document.activeElement.tagName&&"login-check"==document.activeElement.getAttribute("data-function"))return s.view="page-chats",void u();if("open-chat"==document.activeElement.getAttribute("data-function"))return s.view="page-chat",void u();break;case"Backspace":"page-chat"==s.view&&(s.view="page-chats",u())}},c=function(e){if("SELECT"==document.activeElement.nodeName||"date"==document.activeElement.type||"time"==document.activeElement.type)return!1;var t=document.activeElement.tabIndex+e,a=0;if(a=document.activeElement.parentNode.querySelectorAll(".item"),document.activeElement.parentNode.classList.contains("input-parent"))return document.activeElement.parentNode.focus(),!0;"page-chats"==s.view&&(a=document.activeElement.parentNode.querySelectorAll("div#page-chats article"));"page-chat"==s.view&&(a=document.activeElement.parentNode.querySelectorAll("div#page-chat article"));t<=a.length&&a[t].focus(),t==a.length&&a[0].focus();var n=document.activeElement.getBoundingClientRect(),c=n.top-document.body.getBoundingClientRect().top+n.height/2;document.activeElement.parentNode.scrollBy({left:0,top:c-window.innerHeight/2,behavior:"smooth"})},o=!1,i=1e3,r=function(){};document.addEventListener("keydown",(function(e){"Backspace"===e.key&&("options"!=s.view&&"add-edit-event"!=s.view&&"scan"!=s.view||e.preventDefault()),"EndCall"===e.key&&(e.preventDefault(),window.close()),e.repeat||(o=!1,a=setTimeout((function(){o=!0,function(e){switch(e.key){case"0":case"ArrowLeft":break;case"Backspace":window.close()}}(e)}),i)),e.repeat&&("Backspace"==e.key&&(o=!1),e.key)})),document.addEventListener("keyup",(function(e){if(!1===s.visible)return!1;"Backspace"==e.key&&document.activeElement.tagName,clearTimeout(a),o||n(e)})),document.addEventListener("visibilitychange",r,!1)}));